# Sikla Price Sheet Clean Up Script

This script automates the cleaning and formatting of Sikla price sheet Excel files. It performs the following steps:

## Features

1. **Reads All Sheets**: Loads all tabs from the input Excel file (`.xlsm`).
2. **Identifies Main Sheet**: Selects the sheet with the most rows for processing.
3. **Detects Header Row**: Finds the first row containing the keywords "description", "weight", and "price" (case-insensitive, substring match).
4. **Removes Unwanted Rows**:
    - Drops all rows above the detected header row.
    - Removes rows below the header where the description column is empty (including whitespace and NaN values).
    - Removes rows where the description column contains the word "description" (except the header row).
5. **Excel Formatting**:
    - Sets column A width to 18.
    - Sets column C width to 60 and applies wrap text.
    - Auto-width for other columns.
    - Auto height for all rows.
    - Adds filters to the top row.
    - Formats all decimal numbers to two decimal places.
    - Splits and freezes the worksheet at cell D2.
6. **Exports Cleaned Data**:
    - Saves the cleaned and formatted data to a new Excel file (`.xlsx`) in the same folder as the input file.
    - The output filename is the original filename with `_cleaned_up_YYYYMMDD_HHMMSS` appended.


## Usage

1. Place your Sikla price sheet Excel file anywhere on your system.
2. Run the script from the command line, providing the input file path as an argument:
    ```powershell
    python sikla_price_sheet_clean_up.py "C:\path\to\your\file.xlsm"
    ```
    Or, if using a virtual environment:
    ```powershell
    & C:/Users/szil/Repos/excel_wizadry/.venv/Scripts/python.exe sikla_price_sheet_clean_up.py "C:\path\to\your\file.xlsm"
    ```
3. The cleaned and formatted Excel file will be saved in the same folder as the input file, with `_cleaned_up_YYYYMMDD_HHMMSS` appended to the filename.

## Requirements
- Python 3.x
- pandas
- openpyxl

Install dependencies with:
```powershell
pip install pandas openpyxl
```

## Author
Generated by GitHub Copilot

## Known Limitations

- Assumes the input Excel file contains the required columns and header keywords.
- Only processes the sheet with the most rows.
- Formatting logic may not work for highly customized or corrupted files.
