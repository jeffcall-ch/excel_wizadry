# Prompt 7

**Batch Info:** Batch 7/7: ['EHDH']

**Timestamp:** 2025-06-06 13:17:23

## Prompt Content

```

You are a piping engineering assistant.

You are given:
- A summary table of pipe classes, where each row represents a pipe class and columns are its properties.
- Relevant source Excel data that may contain information about these specific pipe classes.
- Extracted key properties from the source data for easier matching.

The source data only includes non-empty cell values and is filtered to show only relevant sections.

IMPORTANT MATCHING RULES:
1. For "Corrosion allowance": Look for values like "0 mm", "1 mm", "4.0 mm", "1.0mm", etc. Maybe there is extra text after it.  The summary shows just the number (0, 1), while source may show "0 mm", "1 mm".
2. For "Material Code": Look for decimal numbers like 1.4401, 1.4404, etc.
3. For "Pressure class": Look for "PN 16", "PN 25", etc. Match the number only.
4. For temperatures: Look for values with °C, may appear in ranges like "-15°C to 100°C".
5. Property names may vary slightly (e.g., "Material" vs "Material Code").
6. For "Diameter from" and "Diameter to" look for a row with diameters mentioned. Look for "DN" or "OD" then series of numbers. We need the smallest and largest here. 
7. For "Min termperature" and "Max temperature" look for a row which mentions "temperature" or "temp" and then series of numbers. We need the smallest and largest here. If a cell contains "RT" this is room temperature, so we can use 20°C as a default value equivalent to 20.
8. For "min pressure" and "max pressure" look for a row which mentions "pressure" or "press" and then series of numbers. We need the smallest and largest here. If a cell contains "atm" this is atmospheric pressure, so we can use 1 atm as a default value equivalent to 1.

Your tasks:
1. For each pipe class in the summary batch, find and extract the corresponding properties from the source data, even if the layouts differ.
2. Compare each property in the summary with the value found in the sources.
3. Return, for each pipe class, a dictionary mapping each property to "match" (if the summary and source agree), "mismatch" (if they differ), or "missing" (if not found in the sources).

IMPORTANT: For "Pipe Class Name" field, always use the ACTUAL pipe class name (e.g., "EFDX", "EFDJ"), NOT "match"/"mismatch"/"missing".

Summary pipe classes:
['EHDH']

Summary columns:
['No', 'Lot', 'Pipe Class Name', 'Standard', 'Pressure class [PN, CL]', 'Min temperature (°C)', 'Max temperature (°C)', 'Diameter from [DN, NPS]', 'Diameter to [DN, NPS]', 'Medium', 'Material Code', 'Material Composition', 'EN <-> ASME material equivalent', 'Corrosion allowance', 'Remarks', 'Document reference', 'Rev.', 'Approved date']

Summary table for current batch:
[{'No': 31, 'Lot': 'WSC', 'Pipe Class Name': 'EHDH', 'Standard': 'EN 13480', 'Pressure class [PN, CL]': 16, 'Min temperature (°C)': 20.0, 'Max temperature (°C)': 400.0, 'Diameter from [DN, NPS]': 'OD12, DN15', 'Diameter to [DN, NPS]': 400, 'Medium': 'Fully Demin. Water (T<100°C)', 'Material Code': 1.4571, 'Material Composition': 'X6CrNiMoTi17-12-2', 'EN <-> ASME material equivalent': 'ASTM A312 TP316TI', 'Corrosion allowance': 0, 'Remarks': 'Only OD12 is present, the rest is DN.', 'Document reference': 'TII-HZI-99003650_2.0_TII Pipe Class Manual WSC, Sheets EN', 'Rev.': 2.0, 'Approved date': 45268}]

Extracted key properties from source data:
{'EHDH': {'Pressure class [PN, CL]': 16, 'Min temperature (°C)': 100, 'Max temperature (°C)': 100, 'Material Code': 1.4404}}

Full relevant source data (filtered for these pipe classes):
[{'file': 'pipe_class_validation_report.xlsx', 'sheet': 'Sheet1', 'data': [['Pipe Class Name', 'No', 'Lot', 'Standard', 'Pressure class [PN, CL]', 'Min temperature (°C)', 'Max temperature (°C)', 'Diameter from [DN, NPS]', 'Diameter to [DN, NPS]', 'Medium', 'Material Code', 'Material Composition', 'EN <-> ASME material equivalent', 'Corrosion allowance', 'Remarks', 'Document reference', 'Rev.', 'Approved date'], ['EFDX', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['EFDJ', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['EHDX', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['EEDX', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['ECDE', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['ECDM', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['EHDQ', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['EHFD', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['EHGN', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['ECCT', 'missing', 'missing', 'missing', 'match', 'mismatch', 'mismatch', 'match', 'match', 'match', 'match', 'missing', 'missing', 'match', 'match', 'missing', 'missing', 'missing'], ['ECFT', 'missing', 'missing', 'missing', 'match', 'match', 'match', 'match', 'match', 'match', 'match', 'missing', 'missing', 'match', 'missing', 'missing', 'missing', 'missing'], ['ECCU', 'missing', 'missing', 'missing', 'match', 'match', 'match', 'match', 'match', 'match', 'match', 'missing', 'missing', 'match', 'missing', 'missing', 'missing', 'missing'], ['ECBA', 'missing', 'missing', 'missing', 'match', 'match', 'match', 'match', 'match', 'match', 'match', 'missing', 'missing', 'match', 'missing', 'missing', 'missing', 'missing'], ['EEBS', 'missing', 'missing', 'missing', 'match', 'match', 'match', 'match', 'match', 'match', 'match', 'missing', 'missing', 'match', 'missing', 'missing', 'missing', 'missing'], ['ECCB', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['ECDB', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['ECDD', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['ECEB', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['ECFB', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['ECHB', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['ECJB', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['ECGA', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['ECHA', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['EDHA', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['EDJA', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['EDFC', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['EDHC', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['EDJC', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['EBJC', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['EBDB', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing'], ['EHDH', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing', 'missing']], 'pipe_class': 'EHDH'}, {'file': 'WSC.xlsm', 'sheet': 'Class EHDH', 'data': [['welded as default standard!', 'System:', 'PT07', 'Material Group:', '15E0 (1.4571)'], ['Medium:', 'Deminwater (T < 100°C)', 'welded as default standard!', 'Press.(design):', 17, 'bar(a)', 'Flange rating:', 'EN PN16', 'Medium:', 'Deminwater (T < 100°C)'], ['check contract about welded or', 'Temp.(design):', 100, '°C', 'Manufac. Type:', 'welded'], ['seamless requirements!', 'Test pressure:', 22.9, 'bar(g)', 'Pipe Class:', 'EHDH'], ['Application limit:', 'Temp:.', '°C', 'RT °C', 100, 150, 200, 250, 300, 350, 400, 'Application limit:', 'Temp:.'], ['Press.:', 'bar(g)', 'w.n.f.2)', 16, 16, 15.6, 14.9, 14.1, 13.3, 12.8, 12.4, 'Press.:'], ['Range of use', 'R.o.U. for this pipe class', 'further possible R.o.U.', 'Range of use'], ['STD Dia. of pipes:', 'DN', 'OD12 11)', '15 12)', '20 3)', 25, '32 3)', 40, 50, '65 3)', 80, 100, '125 3)', 150, 200, 250, 300, 350, 400], ['Ext. Dia. of  pipes:', 'mm', 12, 21.3, 26.9, 33.7, 42.4, 48.3, 60.3, 76.1, 88.9, 114.3, 139.7, 168.3, 219.1, 273, 323.9, 355.6, 406.4, 'n.a. yet for this system'], ['Min. WT of pipes: 1) ', 'mm', 1.5, 1.6, 1.6, 2, 2, 2, 2, 2.3, 2.3, 2.6, 2.6, 2.6, 3.6, 3.6, 4, 4, 5], ['SCH of pipes', '-', 'n.a.'], ['Int. Dia. of pipes', 'mm', 9, 18.1, 23.7, 29.700000000000003, 38.4, 44.3, 56.3, 71.5, 84.30000000000001, 109.1, 134.5, 163.10000000000002, 211.9, 265.8, 315.9, 347.6, 396.4], ['STD Dia. of fittings:', 'DN', 'OD12', 15, '20 3)', 25, '32 3)', 40, 50, '65 3)', 80, 100, '125 3)', 150, 200, 250, 300, 350, 400], ['Ext. Dia. of fittings:', 'mm', 12, 21.3, '20 3)', 25, '32 3)', 48.3, 60.3, 76.1, 88.9, 114.3, 139.7, 168.3, 219.1, 273, 323.9, 355.6, 406.4, 'n.a. yet for this system'], ['Min. WT of fittings: 1)', 'mm', 1.5, 2, 2, 2, 2, 2, 2, 2.3, 2.3, 2.6, 2.6, 2.6, 3.6, 3.6, 4, 4, 5], ['SCH of fittings', 'mm', '-', 1, 1, 2, 2, 2, 2, 2, '2 (3)', '2 (3)', 2, 2, 3, 2, 2, 2, 3], ['Components:', 'DN', 'Description', 'Material', 'Sch./\nRating', 'End\nPrep.', 'Standard', 'Remarks'], ['from ', 'to', 'Branch Table'], ['Pipes', 15, 50, 'Pipe sml - Plain End', '1.4571 (tech. deliv. EN10216-5)', '-', 'PE', 'EN 10216-5', 'Run Pipe', 15, 'TA-1'], [65, 400, 'Pipe wld - Bevelled End', '1.4571 (tech. deliv. EN10217-7)', '-', 'BE', 'EN 10217-7', 'joint coefficient z = 1', '203)'], [65, 400, 'Pipe sml - Bevelled End', '1.4571 (tech. deliv. EN10216-5)', '-', 'BE', 'EN 10216-5', 25, 'TA-4'], ['323)'], [40, 'B-2.3'], ['Pipe bend 4)', 15, 50, 'Pipe sml Bend - 5xDN', '1.4571 (tech. deliv. EN10216-5)', '-', 'PE', 'EN 10216-5', 50, 'B-2.3'], ['Elbow (90°, 45°)', 15, 400, 'Elbow - Type 3D', '1.4571 (tech. deliv. EN10253-4)', '-', 'BW', 'EN 10253-4 (A)', '653)', 'B-2.3'], [80, 'B-2.3'], [100, 'B-2.6'], ['1253)', 'B-2.6'], ['T-fittings &', 15, 80, 'Tee', '1.4571 (tech. deliv. EN10253-4)', '-', 'BW', 'EN 10253-4 (A)', 'Refer to second page\n(Branch Table)', 150, 'B-2.6'], ['Branch outlet (olet)', 100, 400, 'Tee', '1.4571 (tech. deliv. EN10253-4)', '-', 'BW', 'EN 10253-4 (B)', 200, 'B-2.6'], ['-', '-', 'Weldolet acc. to individual calculation', '1.4571 (tech. deliv. EN10217-7)', '-', 'BW', 'EN 13480-3', 250, 'B-2.6'], ['-', '-', 'Weldolet acc. to individual calculation', '1.4571 (tech. deliv. EN10216-5)', '-', 'BW', 'EN 13480-3', 300, 'B-2.6'], ['Temp. Instrumentation', 100, 150, 'Weldolet Ø36/26', '1.4571 (tech. deliv. EN10222-5)', '-', 'W', 'EN 10222-5', 'D4-Thermowell', 350, 'B-2.6'], [200, 400, 'Weldolet Ø36/26', '1.4571 (tech. deliv. EN10222-5)', 'W', 'EN 10222-5', 'D5-Thermowell', 400, 'B-2.6'], ['Thermowell Ø26 / G (1/2")', 1.4571, '-', 'TH', 'DIN 43772', 450], ['Hex head plug G (1/2")', 'A4-70', '-', 'TH', 'DIN 910', 500], ['Press. Instrumentation', 15, 25, 'Tee', '1.4571 (tech. deliv. EN10253-4)', '-', 'BW', 'EN 10253-4 (A)', 600], [50, 400, 'Weldolet (DN15) acc. to individual calculation', '1.4571 (tech. deliv. EN10222-5)', '-', 'W', 'EN 10222-5', 15, '203)'], ['Reducer', 25, 400, 'Reducer (Concentric or Eccentric)', '1.4571 (tech. deliv. EN10253-4)', '-', 'BW', 'EN 10253-4 (A)', 'Up to 3 DN decrements are allowed', 'Branch Pipe'], ['Caps', 15, 400, 'Cap', '1.4571 (tech. deliv. EN10028-7)', '-', 'BW', 'EN 10253-4 (A)'], ['Flanges', 15, 50, 'WN type (11) - RF (B1)', '1.4571 (tech. deliv. EN10222-5)', 'PN40', 'BW/FL', 'EN 1092-1'], [65, 200, 'WN type (11) - RF (B1)', '1.4571 (tech. deliv. EN10222-5)', 'PN16', 'BW/FL', 'EN 1092-1'], ['Blind flanges', 15, 50, 'Blind flange type (05) - RF (B1)', '1.4571 (tech. deliv. EN10028-7)', 'PN40', 'FL', 'EN 1092-1'], [65, 200, 'Blind flange type (05) - RF (B1)', '1.4571 (tech. deliv. EN10028-7)', 'PN16', 'FL', 'EN 1092-1'], ['Bolts', 'M12', 'M33', 'Hexagon bolt', 'A4-70 (EN ISO 3506-1)', 'PN16/40', 'TH', 'ISO 4014/4017'], ['Nuts', 'M12', 'M33', 'Hexagon nut', 'A4-70 (EN ISO 3506-2)', 'PN16/40', 'TH', 'ISO 4032'], ['Gaskets', 15, 400, '1.5 mm compressed (non-asbestos) fibre', 'Fibre', 'PN16/40', 'EN 1514-1', 'Klingersil C4430 or equal', 'Type\nNo.', 'Description'], ['TA', 'Tee Type A (followed by serial No)'], ['Washers', 'PN16', 'EN ISO 7089', 'TB', 'Tee Type B (followed by serial No)'], ['Fittings:', '...', 150, 'according valve list (ball valve)', 1.4404, 'PN16', 'acc. list', 'acc. supplier', 'A', 'Unreinforced (followed by WT)'], ['- Isolating valves', 200, '…', 'according valve list (butterfly valve)', 1.4404, 'PN16', 'acc. list', 'acc. supplier', 'A', 'Unreinforced (followed by WT)'], ['- Non-Return valves', 'B', 'Reinforced inside (followed by WT)'], ['- Strainers', 'W', 'Reinforced outside (followed by bar diameter)'], ['- Steam Traps']], 'pipe_class': 'EHDH'}]

Return only a valid JSON array as your entire response, with no introduction, explanation, or trailing text.
Each element of the array should be a dictionary containing ALL columns from the summary table.

REQUIRED OUTPUT FORMAT - You MUST include ALL 18 columns:
For "Pipe Class Name": Use the actual pipe class name (e.g., "EFDX", "EFDJ")
For all other columns: Use "match"/"mismatch"/"missing"

Example for pipe class EFDX:
{
    "Pipe Class Name": "EFDX",
    "No": "match"/"mismatch"/"missing",
    "Lot": "match"/"mismatch"/"missing",
    "Standard": "match"/"mismatch"/"missing",
    "Pressure class [PN, CL]": "match"/"mismatch"/"missing",
    "Min temperature (°C)": "match"/"mismatch"/"missing",
    "Max temperature (°C)": "match"/"mismatch"/"missing",
    "Diameter from [DN, NPS]": "match"/"mismatch"/"missing",
    "Diameter to [DN, NPS]": "match"/"mismatch"/"missing",
    "Medium": "match"/"mismatch"/"missing",
    "Material Code": "match"/"mismatch"/"missing",
    "Material Composition": "match"/"mismatch"/"missing",
    "EN <-> ASME material equivalent": "match"/"mismatch"/"missing",
    "Corrosion allowance": "match"/"mismatch"/"missing",
    "Remarks": "match"/"mismatch"/"missing",
    "Document reference": "match"/"mismatch"/"missing",
    "Rev.": "match"/"mismatch"/"missing",
    "Approved date": "match"/"mismatch"/"missing"
}

CRITICAL: Your response must include exactly these 18 columns: ['No', 'Lot', 'Pipe Class Name', 'Standard', 'Pressure class [PN, CL]', 'Min temperature (°C)', 'Max temperature (°C)', 'Diameter from [DN, NPS]', 'Diameter to [DN, NPS]', 'Medium', 'Material Code', 'Material Composition', 'EN <-> ASME material equivalent', 'Corrosion allowance', 'Remarks', 'Document reference', 'Rev.', 'Approved date']

```
