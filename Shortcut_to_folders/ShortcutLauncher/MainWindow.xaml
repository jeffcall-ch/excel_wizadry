<Window x:Class="ShortcutLauncher.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Shortcut Launcher"
        Width="400"
        Height="300"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanMinimize"
        ShowInTaskbar="True"
        Loaded="Window_Loaded"
        StateChanged="Window_StateChanged"
        Closing="Window_Closing"
        KeyDown="Window_KeyDown">
    
    <Window.Resources>
        <!-- Style for scrollable MenuItem popups -->
        <Style TargetType="MenuItem">
            <Setter Property="ItemsPanel">
                <Setter.Value>
                    <ItemsPanelTemplate>
                        <VirtualizingStackPanel/>
                    </ItemsPanelTemplate>
                </Setter.Value>
            </Setter>
            <Style.Resources>
                <Style TargetType="ScrollViewer">
                    <Setter Property="MaxHeight" Value="450"/>
                    <!-- 15 items * ~30px per item -->
                    <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
                    <Setter Property="HorizontalScrollBarVisibility" Value="Disabled"/>
                </Style>
            </Style.Resources>
        </Style>
    </Window.Resources>
    
    <Grid>
        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Margin="20">
            <TextBlock Text="ðŸš€ Shortcut Launcher" FontSize="24" FontWeight="Bold" 
                       HorizontalAlignment="Center" Margin="0,0,0,20"/>
            <TextBlock Text="Click a button below or minimize to taskbar:" 
                       FontSize="14" HorizontalAlignment="Center" Margin="0,0,0,20"/>
            
            <Button x:Name="ShowMenuButton" Content="ðŸ“‹ Show Shortcuts Menu" 
                    Height="40" Margin="0,5" FontSize="14" Click="ShowMenuButton_Click"/>
            <Button x:Name="OpenFolderButton" Content="ðŸ“ Open Shortcuts Folder" 
                    Height="40" Margin="0,5" FontSize="14" Click="OpenFolderButton_Click"/>
            <Button x:Name="MinimizeButton" Content="âž– Minimize to Taskbar" 
                    Height="40" Margin="0,5" FontSize="14" Click="MinimizeButton_Click"/>
            <Button x:Name="ExitButton" Content="âŒ Exit Application" 
                    Height="40" Margin="0,5" FontSize="14" Click="ExitButton_Click"/>
            
            <TextBlock Text="ðŸ’¡ Tip: When minimized, click the taskbar icon to show the shortcuts menu" 
                       FontSize="11" Foreground="Gray" HorizontalAlignment="Center" 
                       Margin="0,20,0,0" TextWrapping="Wrap" TextAlignment="Center"/>
        </StackPanel>
    </Grid>
    
    <Window.ContextMenu>
        <ContextMenu x:Name="ShortcutMenu" 
                     Closed="ShortcutMenu_Closed"
                     Placement="Mouse"
                     StaysOpen="True">
        </ContextMenu>
    </Window.ContextMenu>
</Window>
